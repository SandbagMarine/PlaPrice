# 기능 명세: 다중 상점 가격 크롤러 (Multi-Shop Price Crawler)

**Feature Branch**: `001-shop-price-crawler`  
**Created**: 2025-12-30  
**Status**: Draft  
**Input**: "n개의 상점 웹페이지 도메인을 설정하고, 원하는 키워드 또는 제품명을 입력하면 각각의 상점 페이지에서 해당 상품이 존재하는지, 가격은 얼마인지, 품절상태인지 와 같은 정보를 크롤링해서 표와같은형태로 요약해서 보여주는 파이썬 프로그램"

## 사용자 시나리오 및 테스트 *(필수)*

### 사용자 스토리 1 - 단일 상점 가격 조회 (Priority: P1)

사용자는 하나의 상점 웹페이지를 설정하고, 제품명 또는 키워드를 입력하여
해당 상점에서 상품 정보(존재 여부, 가격, 품절 상태)를 조회할 수 있다.
결과는 표 형태로 화면에 표시된다.

**우선순위 이유**: 단일 상점 크롤링은 전체 기능의 핵심 빌딩 블록이다.
이것이 작동해야 다중 상점 확장이 가능하다.

**독립 테스트**: 하나의 테스트 상점 URL과 테스트 키워드를 입력하여,
상품 정보가 표 형태로 출력되는지 확인한다.

**인수 시나리오**:

1. **Given** 사용자가 상점 URL을 설정했고 키워드를 입력했을 때,
   **When** 검색을 실행하면,
   **Then** 해당 상점에서 키워드와 일치하는 상품 목록이 표 형태로 표시된다.
2. **Given** 사용자가 존재하지 않는 키워드를 입력했을 때,
   **When** 검색을 실행하면,
   **Then** "검색 결과 없음" 메시지가 표시된다.
3. **Given** 사용자가 잘못된 URL을 입력했을 때,
   **When** 검색을 실행하면,
   **Then** 적절한 오류 메시지가 표시된다.

---

### 사용자 스토리 2 - 다중 상점 설정 및 관리 (Priority: P2)

사용자는 여러 개의 상점 웹페이지 도메인을 등록하고 관리할 수 있다.
등록된 상점 목록을 조회, 추가, 삭제할 수 있다.

**우선순위 이유**: 다중 상점 비교가 핵심 가치이므로, 상점 관리 기능이
필요하다. P1이 완료된 후 확장한다.

**독립 테스트**: 상점을 추가/삭제하고, 저장된 상점 목록이 유지되는지 확인한다.

**인수 시나리오**:

1. **Given** 사용자가 프로그램을 실행했을 때,
   **When** 새 상점 URL을 추가하면,
   **Then** 상점이 목록에 저장되고 다음 실행 시에도 유지된다.
2. **Given** 상점 목록에 여러 상점이 있을 때,
   **When** 특정 상점을 삭제하면,
   **Then** 해당 상점이 목록에서 제거된다.
3. **Given** 상점 목록이 있을 때,
   **When** 목록을 조회하면,
   **Then** 등록된 모든 상점 URL과 이름이 표시된다.

---

### 사용자 스토리 3 - 다중 상점 동시 검색 및 비교 (Priority: P3)

사용자는 등록된 모든 상점에서 동시에 키워드를 검색하고,
각 상점별 결과를 하나의 비교 표로 볼 수 있다.

**우선순위 이유**: 이 기능이 최종 사용자 가치를 제공한다.
P1, P2가 완료된 후 통합하여 구현한다.

**독립 테스트**: 3개 이상의 상점을 등록하고 키워드 검색 시,
모든 상점 결과가 하나의 비교 표에 표시되는지 확인한다.

**인수 시나리오**:

1. **Given** 3개의 상점이 등록되어 있고 키워드를 입력했을 때,
   **When** 검색을 실행하면,
   **Then** 3개 상점의 결과가 하나의 비교 표에 상점명, 상품명, 가격, 품절상태 컬럼으로 표시된다.
2. **Given** 일부 상점에서 검색 결과가 없을 때,
   **When** 검색을 실행하면,
   **Then** 해당 상점은 "결과 없음"으로 표시되고 나머지 상점 결과는 정상 표시된다.
3. **Given** 일부 상점 접속이 실패했을 때,
   **When** 검색을 실행하면,
   **Then** 실패한 상점은 "접속 오류"로 표시되고 나머지 상점 결과는 정상 표시된다.

---

### 엣지 케이스 (Edge Cases)

- 상점 웹페이지 구조가 변경되어 크롤링이 실패하는 경우 → 오류 메시지 표시 및 다른 상점 결과는 계속 표시
- 네트워크 타임아웃 발생 시 → 타임아웃 메시지 표시, 재시도 옵션 제공
- 동일한 상품이 여러 상점에서 다른 이름으로 등록된 경우 → 키워드 기반 매칭으로 처리 (정확한 상품 매칭은 향후 기능으로)
- 가격 정보가 없거나 "문의" 형태인 경우 → "가격 정보 없음"으로 표시
- 상점이 로봇 차단(robots.txt, CAPTCHA)을 하는 경우 → 적절한 오류 메시지 표시

## 요구사항 *(필수)*

### 기능 요구사항 (Functional Requirements)

- **FR-001**: 시스템은 상점 URL을 등록/수정/삭제할 수 있어야 한다.
- **FR-002**: 시스템은 등록된 상점 목록을 영구 저장(persist)해야 한다.
- **FR-003**: 시스템은 키워드 또는 제품명을 입력받아 검색할 수 있어야 한다.
- **FR-004**: 시스템은 지정된 상점 웹페이지에서 상품 정보를 크롤링할 수 있어야 한다.
- **FR-005**: 크롤링된 정보는 최소한 상품명, 가격, 품절 상태를 포함해야 한다.
- **FR-006**: 시스템은 크롤링 결과를 표(table) 형태로 화면에 표시해야 한다.
- **FR-007**: 시스템은 다중 상점 결과를 하나의 비교 표로 통합 표시할 수 있어야 한다.
- **FR-008**: 시스템은 크롤링 오류 시 적절한 오류 메시지를 표시해야 한다.
- **FR-009**: 시스템은 Windows 데스크탑 환경에서 실행 가능해야 한다.

### 핵심 엔티티 (Key Entities)

- **상점(Shop)**: 크롤링 대상 웹사이트. 속성: 이름, URL, 크롤링 설정(selector 등)
- **검색 결과(SearchResult)**: 크롤링으로 얻은 상품 정보. 속성: 상점명, 상품명, 가격, 품절 여부, 조회 시간
- **검색 요청(SearchQuery)**: 사용자가 입력한 검색 조건. 속성: 키워드, 대상 상점 목록

## 성공 기준 *(필수)*

### 측정 가능한 결과 (Measurable Outcomes)

- **SC-001**: 사용자는 상점 등록부터 검색 결과 확인까지 5분 이내에 완료할 수 있다.
- **SC-002**: 단일 상점 크롤링은 30초 이내에 완료된다. (네트워크 지연 제외)
- **SC-003**: 5개 상점 동시 검색 시 2분 이내에 모든 결과가 표시된다.
- **SC-004**: 크롤링 오류 발생 시 사용자는 오류 원인을 이해할 수 있는 메시지를 받는다.
- **SC-005**: 사용자는 비교 표를 보고 가장 저렴한 상점을 즉시 식별할 수 있다.

## 가정 사항 (Assumptions)

- 대상 상점 웹페이지는 JavaScript 렌더링 없이 HTML 크롤링이 가능하다고 가정한다. (동적 페이지는 향후 기능으로)
- 상점별 크롤링 설정(CSS selector 등)은 사용자가 직접 설정하거나, 사전 정의된 템플릿을 사용한다.
- 초기 버전은 CLI 또는 간단한 GUI로 구현한다. (고급 UI는 향후 기능으로)
- 크롤링 빈도는 수동 실행 기준이며, 자동 스케줄링은 향후 기능으로 고려한다.

